import { useEffect, useRef, useState } from "react";
import { Link } from "react-router-dom";
import UserOne from "../../images/user/user-01.png";

const DropdownUser = () => {
  const [dropdownOpen, setDropdownOpen] = useState(false);
  const trigger = useRef(null);
  const dropdown = useRef(null);

  // close on click outside
  useEffect(() => {
    const clickHandler = ({ target }) => {
      if (!dropdown.current || !trigger.current) return;
      if (
        !dropdownOpen ||
        dropdown.current.contains(target) ||
        trigger.current.contains(target)
      )
        return;
      setDropdownOpen(false);
    };
    document.addEventListener("click", clickHandler);
    return () => document.removeEventListener("click", clickHandler);
  }, [dropdownOpen]);

  // close if the esc key is pressed
  useEffect(() => {
    const keyHandler = ({ keyCode }) => {
      if (!dropdownOpen || keyCode !== 27) return;
      setDropdownOpen(false);
    };
    document.addEventListener("keydown", keyHandler);
    return () => document.removeEventListener("keydown", keyHandler);
  }, [dropdownOpen]);

  return (
    <div className="relative">
      <Link
        ref={trigger}
        onClick={() => setDropdownOpen(!dropdownOpen)}
        className="flex items-center gap-4"
        to="#"
      >
       
        <span className="h-12 w-12 rounded-full">
          <img src={UserOne} alt="User" />
        </span>
        
      </Link>

      <div
        ref={dropdown}
        className={`absolute right-0 mt-4 flex w-62.5 flex-col rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark ${
          dropdownOpen ? "block" : "hidden"
        }`}
      >
        <ul className="flex flex-col gap-5 border-b border-stroke px-6 py-7.5 dark:border-strokedark">
          <li>
            <Link
              to="/profile"
              className="flex items-center gap-3.5 text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base"
            >
              <svg
                className="fill-current"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11 9.62499C8.42188 9.62499 6.35938 7.59687 6.35938 5.12187C6.35938 2.64687 8.42188 0.618744 11 0.618744C13.5781 0.618744 15.6406 2.64687 15.6406 5.12187C15.6406 7.59687 13.5781 9.62499 11 9.62499ZM11 2.16562C9.28125 2.16562 7.90625 3.50624 7.90625 5.12187C7.90625 6.73749 9.28125 8.07812 11 8.07812C12.7188 8.07812 14.0938 6.73749 14.0938 5.12187C14.0938 3.50624 12.7188 2.16562 11 2.16562Z"
                  fill=""
                />
                <path
                  d="M17.7719 21.4156H4.2281C3.5406 21.4156 2.9906 20.8656 2.9906 20.1781V17.0844C2.9906 13.7156 5.7406 10.9656 9.10935 10.9656H12.925C16.2937 10.9656 19.0437 13.7156 19.0437 17.0844V20.1781C19.0094 20.8312 18.4594 21.4156 17.7719 21.4156ZM4.53748 19.8687H17.4969V17.0844C17.4969 14.575 15.4344 12.5125 12.925 12.5125H9.07498C6.5656 12.5125 4.5031 14.575 4.5031 17.0844V19.8687H4.53748Z"
                  fill=""
                />
              </svg>
              My Profile
            </Link>
          </li>
          <li>
            <Link
              to="#"
              className="flex items-center gap-3.5 text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base"
            >
              <svg
                className="fill-current"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M17.6687 1.44374C17.1187 0.893744 16.4312 0.618744 15.675 0.618744H7.42498C6.25623 0.618744 5.25935 1.58124 5.25935 2.78437V4.12499H4.29685C3.88435 4.12499 3.50623 4.46874 3.50623 4.91562C3.50623 5.36249 3.84998 5.70624 4.29685 5.70624H5.25935V10.2781H4.29685C3.88435 10.2781 3.50623 10.6219 3.50623 11.0687C3.50623 11.4812 3.84998 11.8594 4.29685 11.8594H5.25935V16.4312H4.29685C3.88435 16.4312 3.50623 16.775 3.50623 17.2219C3.50623 17.6687 3.84998 18.0125 4.29685 18.0125H5.25935V19.25C5.25935 20.4187 6.22185 21.4156 7.42498 21.4156H15.675C17.2218 21.4156 18.4937 20.1437 18.5281 18.5969V3.47187C18.4937 2.68124 18.2187 1.95937 17.6687 1.44374ZM16.9469 18.5625C16.9469 19.2844 16.3625 19.8344 15.6406 19.8344H7.3906C7.05935 19.8344 6.81248 19.5531 6.81248 19.25V18.0125H14.3469C14.7937 18.0125 15.1719 17.6687 15.1719 17.2219C15.1719 16.775 14.8281 16.4312 14.3469 16.4312H6.81248V11.8594H14.3469C14.7937 11.8594 15.1719 11.5156 15.1719 11.0687C15.1719 10.6219 14.8281 10.2781 14.3469 10.2781H6.81248V5.70624H15.2218C15.6687 5.70624 16.0469 5.36249 16.0469 4.91562C16.0469 4.46874 15.7031 4.12499 15.2218 4.12499H6.81248V2.78437C6.81248 2.41874 7.08435 2.14687 7.42498 2.14687H15.675C15.9281 2.14687 16.1469 2.25624 16.325 2.39999C16.5031 2.57812 16.6469 2.81874 16.6469 3.09374L16.9469 18.5625Z"
                  fill=""
                />
              </svg>
              Account Setting
            </Link>
          </li>
          <li>
            <Link
              to="#"
              className="flex items-center gap-3.5 text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base"
            >
              <svg
                className="fill-current"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M17.6687 1.44374C17.1187 0.893744 16.4312 0.618744 15.675 0.618744H7.42498C6.25623 0.618744 5.25935 1.58124 5.25935 2.78437V4.12499H4.29685C3.88435 4.12499 3.50623 4.46874 3.50623 4.91562C3.50623 5.36249 3.84998 5.70624 4.29685 5.70624H5.25935V10.2781H4.29685C3.88435 10.2781 3.50623 10.6219 3.50623 11.0687C3.50623 11.4812 3.84998 11.8594 4.29685 11.8594H5.25935V16.4312H4.29685C3.88435 16.4312 3.50623 16.775 3.50623 17.2219C3.50623 17.6687 3.84998 18.0125 4.29685 18.0125H5.25935V19.25C5.25935 20.4187 6.22185 21.4156 7.42498 21.4156H15.675C17.2218 21.4156 18.4937 20.1437 18.5281 18.5969V3.47187C18.4937 2.68124 18.2187 1.95937 17.6687 1.44374ZM16.9469 18.5625C16.9469 19.2844 16.3625 19.8344 15.6406 19.8344H7.3906C7.05935 19.8344 6.81248 19.5531 6.81248 19.25V18.0125H14.3469C14.7937 18.0125 15.1719 17.6687 15.1719 17.2219C15.1719 16.775 14.8281 16.4312 14.3469 16.4312H6.81248V11.8594H14.3469C14.7937 11.8594 15.1719 11.5156 15.1719 11.0687C15.1719 10.6219 14.8281 10.2781 14.3469 10.2781H6.81248V5.70624H15.2218C15.6687 5.70624 16.0469 5.36249 16.0469 4.91562C16.0469 4.46874 15.7031 4.12499 15.2218 4.12499H6.81248V2.78437C6.81248 2.41874 7.08435 2.14687 7.42498 2.14687H15.675C15.9281 2.14687 16.1469 2.25624 16.325 2.39999C16.5031 2.57812 16.6469 2.81874 16.6469 3.09374L16.9469 18.5625Z"
                  fill=""
                />
              </svg>
              Profile Setting
            </Link>
          </li>
          <li>
            <Link
              to="/change_avatar"
              className="flex items-center gap-3.5 text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base"
            >
              <svg
                className="fill-current"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M17.6687 1.44374C17.1187 0.893744 16.4312 0.618744 15.675 0.618744H7.42498C6.25623 0.618744 5.25935 1.58124 5.25935 2.78437V4.12499H4.29685C3.88435 4.12499 3.50623 4.46874 3.50623 4.91562C3.50623 5.36249 3.84998 5.70624 4.29685 5.70624H5.25935V10.2781H4.29685C3.88435 10.2781 3.50623 10.6219 3.50623 11.0687C3.50623 11.4812 3.84998 11.8594 4.29685 11.8594H5.25935V16.4312H4.29685C3.88435 16.4312 3.50623 16.775 3.50623 17.2219C3.50623 17.6687 3.84998 18.0125 4.29685 18.0125H5.25935V19.25C5.25935 20.4187 6.22185 21.4156 7.42498 21.4156H15.675C17.2218 21.4156 18.4937 20.1437 18.5281 18.5969V3.47187C18.4937 2.68124 18.2187 1.95937 17.6687 1.44374ZM16.9469 18.5625C16.9469 19.2844 16.3625 19.8344 15.6406 19.8344H7.3906C7.05935 19.8344 6.81248 19.5531 6.81248 19.25V18.0125H14.3469C14.7937 18.0125 15.1719 17.6687 15.1719 17.2219C15.1719 16.775 14.8281 16.4312 14.3469 16.4312H6.81248V11.8594H14.3469C14.7937 11.8594 15.1719 11.5156 15.1719 11.0687C15.1719 10.6219 14.8281 10.2781 14.3469 10.2781H6.81248V5.70624H15.2218C15.6687 5.70624 16.0469 5.36249 16.0469 4.91562C16.0469 4.46874 15.7031 4.12499 15.2218 4.12499H6.81248V2.78437C6.81248 2.41874 7.08435 2.14687 7.42498 2.14687H15.675C15.9281 2.14687 16.1469 2.25624 16.325 2.39999C16.5031 2.57812 16.6469 2.81874 16.6469 3.09374L16.9469 18.5625Z"
                  fill=""
                />
              </svg>
            Change Avatar
            </Link>
          </li>
          <li>
            <Link
              to="/#"
              className="flex items-center gap-3.5 text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base"
            >
              <svg
                className="fill-current"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.25 21.3812H16.4781C16.0719 21.3812 15.7469 21.0562 15.7469 20.65C15.7469 20.2437 16.0719 19.9187 16.4781 19.9187H19.25C19.6562 19.9187 19.9812 19.5937 19.9812 19.1875V2.81249C19.9812 2.40624 19.6562 2.08124 19.25 2.08124H2.75C2.34375 2.08124 2.01875 2.40624 2.01875 2.81249V19.1875C2.01875 19.5937 2.34375 19.9187 2.75 19.9187H5.52185C5.9281 19.9187 6.2531 20.2437 6.2531 20.65C6.2531 21.0562 5.9281 21.3812 5.52185 21.3812H2.75C1.47185 21.3812 0.418732 20.3281 0.418732 19.05V2.81249C0.418732 1.53437 1.47185 0.48124 2.75 0.48124H19.25C20.5281 0.48124 21.5812 1.53437 21.5812 2.81249V19.1875C21.5812 20.4281 20.5281 21.3812 19.25 21.3812Z"
                  fill=""
                />
                <path
                  d="M10.9937 15.9656C10.6969 15.9656 10.4344 15.7937 10.3094 15.5218L7.48748 9.86561C7.2781 9.49061 7.41873 9.01874 7.79373 8.80936C8.16873 8.59999 8.6406 8.74061 8.84998 9.11561L11.0094 13.3468L13.2344 9.11561C13.4437 8.74061 13.9156 8.59999 14.2906 8.80936C14.6656 9.01874 14.8062 9.49061 14.5969 9.86561L11.6781 15.5218C11.5281 15.7937 11.2656 15.9656 10.9937 15.9656Z"
                  fill=""
                />
                <path
                  d="M14.3875 13.0844H7.61558C7.20933 13.0844 6.88433 12.7594 6.88433 12.3531C6.88433 11.9469 7.20933 11.6219 7.61558 11.6219H14.3875C14.7937 11.6219 15.1187 11.9469 15.1187 12.3531C15.1187 12.7594 14.7937 13.0844 14.3875 13.0844Z"
                  fill=""
                />
              </svg>
              Settings
            </Link>
          </li>
        </ul>
        <button className="flex w-full items-center gap-3.5 px-6 py-4 text-left text-sm font-medium duration-300 ease-in-out hover:text-primary lg:text-base">
          <svg
            className="fill-current"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M19 4H14.82C14.4 2.84 13.3 2 12 2C10.7 2 9.6 2.84 9.18 4H5C3.9 4 3 4.9 3 6V20C3 21.1 3.9 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM12 4C12.55 4 13 4.45 13 5C13 5.55 12.55 6 12 6C11.45 6 11 5.55 11 5C11 4.45 11.45 4 12 4ZM19 20H5V6H9V8H15V6H19V20Z"
              fill=""
            />
            <path d="M13.5 18H11.5V14H9.5V12H13.5V18Z" fill="" />
          </svg>
          Log Out
        </button>
      </div>
    </div>
  );
};

export default DropdownUser;
